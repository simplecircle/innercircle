= form_for(@company, :html=>{multipart:true, :class=> 'form-horizontal'}) do |co|
  - if @user && @mode != 'update' && !@user.god?
    = co.fields_for :users, @user do |user|
      .control-group.control-group-header-label
        %label.control-label
        .controls
          %h3 Your Info
      %hr.mtn
      .control-group
        %label.control-label{:for=>:first_name} * First Name
        .controls
          = text_field 'company[users_attributes][0][profile_attributes]', 'first_name', {:class => "span12", :value => @profile.first_name}
          .inline_error= @company.errors[:first_name].first
      .control-group
        %label.control-label{:for=>:last_name} * Last Name
        .controls
          = text_field 'company[users_attributes][0][profile_attributes]', 'last_name', {:class => "span12", :value => @profile.last_name}
          .inline_error= @company.errors[:last_name].first
      .control-group
        %label.control-label{:for=>:email} * Email
        .controls
          = user.text_field :email, :class=>'span12'
          .inline_error= @company.users.first.errors[:email].first
          %span.help-block.small Receipts and account notices will be sent here
      .control-group
        %label.control-label{:for=>:password} * Password
        .controls
          = user.password_field :password, :class=>'span12'
          .inline_error= @company.users.first.errors[:password].first
  .control-group.control-group-header-label
    %label.control-label
    .controls
      %h3 Company Info
  %hr.mtn

  .control-group
    %label.control-label{:for=>:name} * Company Name
    .controls
      = co.text_field :name, :class=>'span12'
      .inline_error= @company.errors[:name].first

  .control-group
    %label.control-label{:for=>:website_url} * Website
    .controls
      = co.text_field :website_url, :class=>'span12'
      .inline_error= @company.errors[:website_url].first

  .control-group
    %label.control-label{:for=>:short_description} 
      * Short Description
    .controls
      = co.text_area :short_description, :class=>'span12 pam', :maxlength=>"80", :rows=>"3"
      %span.help-block.small 80 characters max
      .inline_error= @company.errors[:short_description].first

  .control-group
    %label.control-label{:for=>:hq} * Headquarters
    .controls.controls-row
      = co.text_field :hq_city, {:class=>'span8', :placeholder=>'City'}
      = co.select :hq_state, Company.states, {}, {:class=> 'span4', :placeholder => "State"}
      .inline_error= @company.errors[:hq_city].first
      .inline_error= @company.errors[:hq_state].first

  .control-group
    %label.control-label{:for=>:employee_count} * Employees
    .controls.controls-row
      = co.select :employee_count, Company.employee_counts, {}, {:class=> 'span12'}
      .inline_error= @company.errors[:employee_count].first

  .control-group
    %label.control-label Company Categories
    .controls.controls-row
      = co.fields_for :verticals do |company_verticals|
        - Vertical.order(:name).each do |v|
          %label.checkbox{:for=>"vertical_#{v.id.to_s}", :class=>"two-column-checkbox-label span6"}
            = check_box_tag("vertical_#{v.id.to_s}", v.id, (@verticals.include?(v.id) if @verticals), name: 'verticals[]')
            = v.name
        
  .control-group
    %label.control-label * Company logo
    .controls.controls-row
      = image_tag(@company.logo, :width => 100) if @company.logo?
      = co.file_field :logo
      = co.hidden_field :logo_cache, :value => @company.logo_cache
      .inline_error= @company.errors[:logo].first
  
  .control-group.control-group-header-label
    %label.control-label
    .controls
      %h3 Content Channels
  %hr.mtn

  .control-group
    %label.control-label{:for=>:instagram_username} Instagram username
    .controls.controls-row
      = co.text_field :instagram_username, {:class=>'span10', :placeholder=>'username'}
      %label.span1.radio-label{:for=>"company_instagram_username_auto_publish_on"}
        On
        = co.radio_button :instagram_username_auto_publish, "on", :checked=> @company.instagram_username_auto_publish
      %label.span1.radio-label{:for=>"company_instagram_username_auto_publish_off"}
        Off
        = co.radio_button :instagram_username_auto_publish, "off", :checked=> !@company.instagram_username_auto_publish
  .control-group
    %label.control-label{:for=>:instagram_uid} Instagram location
    .controls.controls-row
      = co.text_field :instagram_uid, {:class=>'span10', :placeholder=>'instagram or foursquare location id'}
      %label.span1.radio-label{:for=>"company_instagram_location_auto_publish_on"}
        On
        = co.radio_button :instagram_location_auto_publish, "on", :checked=> @company.instagram_location_auto_publish
      %label.span1.radio-label{:for=>"company_instagram_location_auto_publish_off"}
        Off
        = co.radio_button :instagram_location_auto_publish, "off", :checked=> !@company.instagram_location_auto_publish
  .control-group
    %label.control-label{:for=>:facebook} Facebook
    .controls.controls-row
      = co.text_field :facebook, {:class=>'span10', :placeholder=>'username'}
      %label.span1.radio-label{:for=>"company_facebook_auto_publish_on"}
        On
        = co.radio_button :facebook_auto_publish, "on", :checked=> @company.facebook_auto_publish
      %label.span1.radio-label{:for=>"company_facebook_auto_publish_off"}
        Off
        = co.radio_button :facebook_auto_publish, "off", :checked=> !@company.facebook_auto_publish
  .control-group
    %label.control-label{:for=>:tumblr} Tumblr
    .controls.controls-row
      = co.text_field :tumblr, {:class=>'span10', :placeholder=>'tumblr page - don\'t include ".tumblr.com"'}
      %label.span1.radio-label{:for=>"company_tumblr_auto_publish_on"}
        On
        = co.radio_button :tumblr_auto_publish, "on", :checked=> @company.tumblr_auto_publish
      %label.span1.radio-label{:for=>"company_tumblr_auto_publish_off"}
        Off
        = co.radio_button :tumblr_auto_publish, "off", :checked=> !@company.tumblr_auto_publish
  .control-group
    %label.control-label{:for=>:foursquare_v2_id} Foursquare
    .controls.controls-row
      = co.text_field :foursquare_v2_id, {:class=>'span10', :placeholder=>'foursquare location id'}
      %label.span1.radio-label{:for=>"company_foursquare_auto_publish_on"}
        On
        = co.radio_button :foursquare_auto_publish, "on", :checked=> @company.foursquare_auto_publish
      %label.span1.radio-label{:for=>"company_foursquare_auto_publish_off"}
        Off
        = co.radio_button :foursquare_auto_publish, "off", :checked=> !@company.foursquare_auto_publish
  .control-group
    %label.control-label{:for=>:jobs_page} Jobs Page
    .controls
      = co.text_field :jobs_page, {:class=>'span12', :placeholder=>'jobs.company.com'}

  %p
  .control-group
    %label.control-label
    .controls
      = co.submit @submit_button_text || "Create account", class:"btn btn-large mtl span12"